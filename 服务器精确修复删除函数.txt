# æœåŠ¡å™¨ç²¾ç¡®ä¿®å¤åˆ é™¤å‡½æ•°

## ğŸ¯ åªä¿®å¤åˆ é™¤å‡½æ•°ä¸­çš„è¡¨åï¼ˆç²¾ç¡®æ›¿æ¢ï¼Œä¸å½±å“å…¶ä»–ä»£ç ï¼‰

```bash
cd /var/www/activities_management/backend/controllers

# å¤‡ä»½æ–‡ä»¶
cp giftController.js giftController.js.bak2

# ç²¾ç¡®ä¿®å¤åˆ é™¤å‡½æ•°ä¸­çš„ä¸¤å¤„è¡¨å
sed -i '236s/FROM gifts WHERE gift_id/FROM gift_items WHERE gift_id/' giftController.js
sed -i '246s/DELETE FROM gifts WHERE gift_id/DELETE FROM gift_items WHERE gift_id/' giftController.js

# éªŒè¯ä¿®å¤
echo "=== æ£€æŸ¥ä¿®å¤ç»“æœ ==="
grep -A 5 "exports.deleteGift" giftController.js | head -15

# é‡å¯æœåŠ¡
pm2 restart all --update-env

# æŸ¥çœ‹æ—¥å¿—ç¡®è®¤
sleep 2
pm2 logs activities-backend --lines 10
```

## ğŸ” å¦‚æœä¸Šé¢çš„è¡Œå·ä¸å¯¹ï¼Œä½¿ç”¨æ›´ç²¾ç¡®çš„æ›¿æ¢

```bash
cd /var/www/activities_management/backend/controllers

# æ–¹æ³•1ï¼šä½¿ç”¨ä¸Šä¸‹æ–‡åŒ¹é…ï¼ˆæ›´å®‰å…¨ï¼‰
sed -i '/exports\.deleteGift/,/success(res, null, .åˆ é™¤æˆåŠŸ.)/ {
  s/FROM gifts WHERE gift_id/FROM gift_items WHERE gift_id/g
  s/DELETE FROM gifts WHERE gift_id/DELETE FROM gift_items WHERE gift_id/g
}' giftController.js

# éªŒè¯
grep -A 15 "exports.deleteGift" giftController.js

# é‡å¯
pm2 restart all --update-env
```

